<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ø¯Ø±Ø³ ÙˆØµÙ Ø§Ù„Ø´Ø®ØµÙŠØ©</title>
<style>
  body {
    font-family: "Cairo", sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    margin: 0;
    padding: 20px;
    color: #2d3748;
  }
  .container {
    max-width: 900px;
    margin: auto;
    background: #fff;
    border-radius: 20px;
    padding: 25px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  }
  h1 {
    text-align: center;
    color: #4f46e5;
  }
  .form-group {
    margin-bottom: 15px;
  }
  label {
    font-weight: bold;
  }
  input, textarea, select {
    width: 100%;
    padding: 10px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-family: inherit;
  }
  button {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    color: #fff;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    font-size: 1rem;
    cursor: pointer;
    width: 100%;
  }
  button:hover {
    opacity: 0.9;
  }
  .student-work {
    background: #f0fff4;
    border: 2px solid #48bb78;
    border-radius: 10px;
    padding: 15px;
    margin-top: 15px;
  }
  .student-name {
    font-weight: bold;
    color: #2f855a;
  }
  .empty-state {
    text-align: center;
    color: #718096;
    margin-top: 30px;
  }
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ–‹ï¸ Ø¯Ø±Ø³: ÙˆØµÙ Ø§Ù„Ø´Ø®ØµÙŠØ©</h1>
  <p style="text-align:center;">Ø¥Ø¹Ø¯Ø§Ø¯: <strong>Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ</strong> â€“ Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</p>
  
  <h2>âœï¸ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠ</h2>
  <form id="characterForm">
    <div class="form-group">
      <label>Ø§Ù„Ø´Ø¹Ø¨Ø©:</label>
      <select id="studentClass" required>
        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ø¹Ø¨Ø©</option>
        <option>Ø§Ù„Ø®Ø§Ù…Ø³ - 1</option>
        <option>Ø§Ù„Ø®Ø§Ù…Ø³ - 2</option>
        <option>Ø§Ù„Ø®Ø§Ù…Ø³ - 3</option>
      </select>
    </div>
    <div class="form-group">
      <label>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</label>
      <input type="text" id="studentName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§..." required />
    </div>
    <div class="form-group">
      <label>Ø§Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠØ©:</label>
      <input type="text" id="characterName" placeholder="Ù…Ø«Ø§Ù„: ÙˆØ§Ù„Ø¯ÙŠØŒ ÙØ§Ø·Ù…Ø©ØŒ Ø£Ø­Ù…Ø¯..." required />
    </div>
    <div class="form-group">
      <label>Ø§Ù„ØµÙØ§Øª Ø§Ù„Ø¬Ø³Ø¯ÙŠØ© (Ø§Ù„Ù…Ø§Ø¯ÙŠØ©):</label>
      <textarea id="physicalTraits" placeholder="Ù…Ø«Ø§Ù„: Ø·ÙˆÙŠÙ„ Ø§Ù„Ù‚Ø§Ù…Ø©ØŒ Ù„Ù‡ Ø´Ø¹Ø± Ø£Ø³ÙˆØ¯..." required></textarea>
    </div>
    <div class="form-group">
      <label>Ø§Ù„ØµÙØ§Øª Ø§Ù„Ù†ÙØ³ÙŠØ© (Ø§Ù„Ù…Ø¹Ù†ÙˆÙŠØ©):</label>
      <textarea id="psychologicalTraits" placeholder="Ù…Ø«Ø§Ù„: ÙƒØ±ÙŠÙ…ØŒ ØµØ¨ÙˆØ±ØŒ Ø°ÙƒÙŠ..." required></textarea>
    </div>
    <div class="form-group">
      <label>Ø§Ù„Ø£Ø¯Ù„Ø© Ø£Ùˆ Ø§Ù„Ù…ÙˆØ§Ù‚Ù:</label>
      <textarea id="textEvidence" placeholder="Ù…Ø«Ø§Ù„: Ø³Ø§Ø¹Ø¯ Ø²Ù…Ù„Ø§Ø¡Ù‡ ÙÙŠ Ø§Ù„ØµÙ..."></textarea>
    </div>
    <button type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙˆØµÙ</button>
  </form>

  <h2 style="margin-top:40px;">ğŸŒŸ Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨</h2>
  <div id="worksContainer" class="empty-state">Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø£ÙŠ Ø£Ø¹Ù…Ø§Ù„ Ø¨Ø¹Ø¯.</div>
</div>

<script>
const scriptURL = ("https://script.google.com/macros/s/AKfycbzRXwPBDixQVIfhu4IiAIeuJ4-oZ9_0MKqVKHSChNpSnKaH_2CbGHyzYpL_wXBzuquS/exec");


async function loadWorks() {
  try {
    const res = await fetch(scriptURL);
    const data = await res.json();
    const container = document.getElementById("worksContainer");

    if (data.length === 0) {
      container.innerHTML = '<div class="empty-state">Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø£ÙŠ Ø£Ø¹Ù…Ø§Ù„ Ø¨Ø¹Ø¯.</div>';
      return;
    }

    container.innerHTML = data
      .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
      .map(w => `
        <div class="student-work">
          <div class="student-name">ğŸ‘¤ ${w.student_name} - ${w.student_class}</div>
          <div><strong>Ø§Ù„Ø´Ø®ØµÙŠØ©:</strong> ${w.character_name}</div>
          <div><strong>Ø§Ù„ØµÙØ§Øª Ø§Ù„Ø¬Ø³Ø¯ÙŠØ©:</strong> ${w.physical_traits}</div>
          <div><strong>Ø§Ù„ØµÙØ§Øª Ø§Ù„Ù†ÙØ³ÙŠØ©:</strong> ${w.psychological_traits}</div>
          ${w.text_evidence ? `<div><strong>Ø§Ù„Ø¯Ù„ÙŠÙ„:</strong> ${w.text_evidence}</div>` : ""}
          <div style="font-size:0.8rem;color:#718096;">ğŸ“… ${new Date(w.created_at).toLocaleDateString("ar-SA")}</div>
        </div>
      `).join("");
  } catch (e) {
    console.error(e);
  }
}

document.getElementById("characterForm").addEventListener("submit", async e => {
  e.preventDefault();
  const payload = {
    student_name: studentName.value.trim(),
    student_class: studentClass.value.trim(),
    character_name: characterName.value.trim(),
    physical_traits: physicalTraits.value.trim(),
    psychological_traits: psychologicalTraits.value.trim(),
    text_evidence: textEvidence.value.trim()
  };

  const btn = e.target.querySelector("button");
  btn.disabled = true;
  btn.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";

  try {
    const res = await fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify(payload),
      headers: { "Content-Type": "application/json" }
    });
    if (res.ok) {
      alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙˆØµÙÙƒ Ø¨Ù†Ø¬Ø§Ø­!");
      e.target.reset();
      loadWorks();
    } else {
      alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
    }
  } catch {
    alert("âš ï¸ ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.");
  }
  btn.disabled = false;
  btn.textContent = "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙˆØµÙ";
});

loadWorks();
</script>
</body>
</html>
